{"ast":null,"code":"import axios from 'axios';\nimport { getToken } from './token';\nconst BACKEND_URL = 'https://12.react.pages.academy/six-cities-simple';\nconst REQUEST_TIMEOUT = 5000;\nconst shouldDisplayError = response => !!StatusCodeMapping[response.status];\nexport const createAPI = () => {\n  const api = axios.create({\n    baseURL: BACKEND_URL,\n    timeout: REQUEST_TIMEOUT\n  });\n  api.interceptors.request.use(config => {\n    const token = getToken();\n    if (token && config.headers) {\n      config.headers['x-token'] = token;\n    }\n    return config;\n  });\n  api.interceptors.response.use(response => response, error => {\n    if (error.response && shouldDisplayError(error.response)) {\n      toast.warn(error.response.data.error);\n    }\n    throw error;\n  });\n  return api;\n};","map":{"version":3,"names":["axios","getToken","BACKEND_URL","REQUEST_TIMEOUT","shouldDisplayError","response","StatusCodeMapping","status","createAPI","api","create","baseURL","timeout","interceptors","request","use","config","token","headers","error","toast","warn","data"],"sources":["C:/Users/Cody/Documents/GitHub/2205815-six-cities-simple-12/project/src/services/API.ts"],"sourcesContent":["import axios, {AxiosError, AxiosInstance, AxiosRequestConfig, AxiosResponse} from 'axios';\r\nimport {getToken} from './token';\r\n\r\nconst BACKEND_URL = 'https://12.react.pages.academy/six-cities-simple';\r\nconst REQUEST_TIMEOUT = 5000;\r\n\r\nconst shouldDisplayError = (response: AxiosResponse) => !!StatusCodeMapping[response.status];\r\n\r\nexport const createAPI = (): AxiosInstance => {\r\n  const api = axios.create({\r\n    baseURL: BACKEND_URL,\r\n    timeout: REQUEST_TIMEOUT,\r\n  });\r\n\r\n  api.interceptors.request.use(\r\n    (config: AxiosRequestConfig) => {\r\n      const token = getToken();\r\n\r\n      if (token && config.headers) {\r\n        config.headers['x-token'] = token;\r\n      }\r\n\r\n      return config;\r\n    },\r\n  );\r\n\r\n  api.interceptors.response.use(\r\n    (response) => response,\r\n    (error: AxiosError<{error: string}>) => {\r\n      if (error.response && shouldDisplayError(error.response)) {\r\n        toast.warn(error.response.data.error);\r\n      }\r\n\r\n      throw error;\r\n    }\r\n  );\r\n\r\n  return api;\r\n};\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAsE,OAAO;AACzF,SAAQC,QAAQ,QAAO,SAAS;AAEhC,MAAMC,WAAW,GAAG,kDAAkD;AACtE,MAAMC,eAAe,GAAG,IAAI;AAE5B,MAAMC,kBAAkB,GAAIC,QAAuB,IAAK,CAAC,CAACC,iBAAiB,CAACD,QAAQ,CAACE,MAAM,CAAC;AAE5F,OAAO,MAAMC,SAAS,GAAGA,CAAA,KAAqB;EAC5C,MAAMC,GAAG,GAAGT,KAAK,CAACU,MAAM,CAAC;IACvBC,OAAO,EAAET,WAAW;IACpBU,OAAO,EAAET;EACX,CAAC,CAAC;EAEFM,GAAG,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CACzBC,MAA0B,IAAK;IAC9B,MAAMC,KAAK,GAAGhB,QAAQ,EAAE;IAExB,IAAIgB,KAAK,IAAID,MAAM,CAACE,OAAO,EAAE;MAC3BF,MAAM,CAACE,OAAO,CAAC,SAAS,CAAC,GAAGD,KAAK;IACnC;IAEA,OAAOD,MAAM;EACf,CAAC,CACF;EAEDP,GAAG,CAACI,YAAY,CAACR,QAAQ,CAACU,GAAG,CAC1BV,QAAQ,IAAKA,QAAQ,EACrBc,KAAkC,IAAK;IACtC,IAAIA,KAAK,CAACd,QAAQ,IAAID,kBAAkB,CAACe,KAAK,CAACd,QAAQ,CAAC,EAAE;MACxDe,KAAK,CAACC,IAAI,CAACF,KAAK,CAACd,QAAQ,CAACiB,IAAI,CAACH,KAAK,CAAC;IACvC;IAEA,MAAMA,KAAK;EACb,CAAC,CACF;EAED,OAAOV,GAAG;AACZ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}